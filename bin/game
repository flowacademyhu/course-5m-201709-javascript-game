#!/usr/bin/env nodejs
'use strict';
const gameArea = require('../data/game-area/game-field/index');
const read = require('readline-sync');
const position = require('../data/game-area/starter-position');
const matrixCurrentPosition = require('../data/game-area/matrix-current-position');
const map = require('../data/game-area/index');

let gameIsRunning = true;

function gameWin (position) {
  if (position[0] === 5 && position[1] === 4) {
    console.log('Nyeréé! Ügyes vagy!');
    gameIsRunning = false;
  }
}

function go (direction) {
  let coordOne = position[1];
  let coordTwo = position[0];

  switch (direction) {
    case 'kelet':
      coordTwo++;
      break;
    case 'nyugat':
      coordTwo--;
      break;
    case 'észak':
      coordOne--;
      break;
    case 'dél':
      coordOne++;
      break;
    default:
      console.log('Merre?');
  }

  if (typeof matrix[coordTwo] === 'object' &&
      typeof matrix[coordOne] === 'object' &&
      gameArea[matrix[coordOne][coordTwo]].accessible) {
    position[0] = coordTwo;
    position[1] = coordOne;
  } else {
    console.log('Erre nem lehet menni.');
  }
  matrixCurrentPosition(position[1], position[0], matrix, gameArea);
}

// init map
let matrix = map();

while (gameIsRunning) {
  const input = read.question('>>');
  const splittedText = input.split(' ');
  console.log('--------------------------------------');

  switch (splittedText[0]) {
    case 'kilépés':
      gameIsRunning = false;
      break;
    case 'menj':
      go(splittedText[1]);
      break;
    default:
      console.log('Tanulj meg magyarul!');
  }
  gameWin(position);
}
