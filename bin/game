#!/usr/bin/env nodejs
'use strict';
const gameArea = require('../data/game-area/game-field/index');
const read = require('readline-sync');

let gameIsRunning = true;
// x es y koordinata
let position = [0, 9];

function gameWin (position) {
  if (position[0] === 5 && position[1] === 4) {
    console.log('Nyeréé! Ügyes vagy!');
    gameIsRunning = false;
  }
}

function matrixCurrentPosition (coordOne, coordTwo, matrix, gameArea) {
  console.log(gameArea[matrix[coordOne][coordTwo]].desc);
  console.log('--------------------------------------');

  if (matrixEdgeCheck(coordTwo, coordOne - 1, matrix)) {
    console.log('Tőled északra ' + gameArea[matrix[coordOne - 1][coordTwo]].shortDesc);
  } else {
    console.log('Tőled északra piciny világod szélét látod, a leesés fenyeget! JUJJUJ');
  }

  if (matrixEdgeCheck(coordTwo, coordOne + 1, matrix)) {
    console.log('Tőled délre ' + gameArea[matrix[coordOne + 1][coordTwo]].shortDesc);
  } else {
    console.log('Tőled délre piciny világod szélét látod, a leesés fenyeget! JUJJUJ');
  }

  if (matrixEdgeCheck(coordTwo + 1, coordOne, matrix)) {
    console.log('Tőled keletre ' + gameArea[matrix[coordOne][coordTwo + 1]].shortDesc);
  } else {
    console.log('Tőled keletre piciny világod szélét látod, a leesés fenyeget! JUJJUJ');
  }

  if (matrixEdgeCheck(coordTwo - 1, coordOne, matrix)) {
    console.log('Tőled nyugatra ' + gameArea[matrix[coordOne][coordTwo - 1]].shortDesc);
  } else {
    console.log('Tőled nyugatra piciny világod szélét látod, a leesés fenyeget! JUJJUJ');
  }
}

function matrixEdgeCheck (x, y, matrix) {
  if (typeof matrix[x] === 'object' && typeof matrix[y] === 'object') {
    return true;
  } else {
    return false;
  }
}

function map () {
  let matrix = [];
  let n = 0;

  for (let i = 0; i < 10; i++) {
    matrix[i] = [];
    for (let j = 0; j < 10; j++) {
      matrix[i][j] = n;
      n++;
    }
  }
  matrixCurrentPosition(position[1], position[0], matrix, gameArea);
  return matrix;
}

function go (direction) {
  let coordOne = position[1];
  let coordTwo = position[0];

  switch (direction) {
    case 'kelet':
      coordTwo++;
      break;
    case 'nyugat':
      coordTwo--;
      break;
    case 'észak':
      coordOne--;
      break;
    case 'dél':
      coordOne++;
      break;
    default:
      console.log('Merre?');
  }

  if (typeof matrix[coordTwo] === 'object' &&
      typeof matrix[coordOne] === 'object' &&
      gameArea[matrix[coordOne][coordTwo]].accessible) {
    position[0] = coordTwo;
    position[1] = coordOne;
  } else {
    console.log('Erre nem lehet menni.');
  }
  matrixCurrentPosition(position[1], position[0], matrix, gameArea);
}

// init map
let matrix = map();

while (gameIsRunning) {
  const input = read.question('>>');
  const splittedText = input.split(' ');
  console.log('--------------------------------------');

  switch (splittedText[0]) {
    case 'kilépés':
      gameIsRunning = false;
      break;
    case 'menj':
      go(splittedText[1]);
      break;
    default:
      console.log('Tanulj meg magyarul!');
  }
  gameWin(position);
}
